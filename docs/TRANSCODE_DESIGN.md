# è§†é¢‘è½¬ç åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ ä¸€ã€åŠŸèƒ½æ¦‚è¿°

è§†é¢‘è½¬ç æ˜¯å°†è§†é¢‘ä»ä¸€ç§æ ¼å¼/ç¼–ç è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼/ç¼–ç çš„è¿‡ç¨‹ï¼Œæ»¡è¶³ä¸åŒæ’­æ”¾è®¾å¤‡ã€å¹³å°å’Œåœºæ™¯çš„éœ€æ±‚ã€‚

---

## ğŸ¯ äºŒã€åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒåŠŸèƒ½

- âœ… æ”¯æŒå¸¸è§è§†é¢‘æ ¼å¼è½¬æ¢ï¼ˆMP4, MKV, AVI, MOV, FLV, WebM ç­‰ï¼‰
- âœ… æ”¯æŒå¤šç§è§†é¢‘ç¼–ç ï¼ˆH.264, H.265/HEVC, VP9, AV1ï¼‰
- âœ… æ”¯æŒéŸ³é¢‘ç¼–ç é€‰æ‹©ï¼ˆAAC, MP3, Opus, FLACï¼‰
- âœ… æ”¯æŒåˆ†è¾¨ç‡è°ƒæ•´ï¼ˆä¿æŒåŸå§‹/è‡ªå®šä¹‰ï¼‰
- âœ… æ”¯æŒå¸§ç‡è°ƒæ•´ï¼ˆä¿æŒåŸå§‹/è‡ªå®šä¹‰ï¼‰
- âœ… æ”¯æŒæ¯”ç‰¹ç‡æ§åˆ¶ï¼ˆCRF/CBR/VBRï¼‰
- âœ… ç¡¬ä»¶åŠ é€Ÿæ”¯æŒï¼ˆVideoToolbox, NVENC, QSVï¼‰

### 2.2 é«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

- ğŸ”„ è§†é¢‘è£å‰ªï¼ˆæ—¶é—´èŒƒå›´ï¼‰
- ğŸ”„ è§†é¢‘æ—‹è½¬/ç¿»è½¬
- ğŸ”„ æ·»åŠ æ°´å°
- ğŸ”„ è°ƒæ•´éŸ³é‡
- ğŸ”„ æ‰¹é‡è½¬ç 
- ğŸ”„ é¢„è®¾æ¨¡æ¿ï¼ˆWeb ä¼˜åŒ–ã€ç§»åŠ¨è®¾å¤‡ã€é«˜è´¨é‡ç­‰ï¼‰

---

## ğŸ¨ ä¸‰ã€UI è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§†é¢‘è½¬ç                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  ğŸ“ è¾“å…¥æ–‡ä»¶ï¼š                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é€‰æ‹©è§†é¢‘æ–‡ä»¶...        [æµè§ˆ...]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â„¹ï¸ æ–‡ä»¶ä¿¡æ¯ï¼š1920x1080, 25fps, H.264   â”‚
â”‚                                          â”‚
â”‚  âš™ï¸ è¾“å‡ºè®¾ç½®                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ ¼å¼ï¼š     [MP4 â–¼]               â”‚   â”‚
â”‚  â”‚ è§†é¢‘ç¼–ç ï¼š [H.264 â–¼]             â”‚   â”‚
â”‚  â”‚ éŸ³é¢‘ç¼–ç ï¼š [AAC â–¼]               â”‚   â”‚
â”‚  â”‚ åˆ†è¾¨ç‡ï¼š   [ä¿æŒåŸå§‹ â–¼]          â”‚   â”‚
â”‚  â”‚ å¸§ç‡ï¼š     [ä¿æŒåŸå§‹ â–¼]          â”‚   â”‚
â”‚  â”‚ è´¨é‡ï¼š     CRF [23] â”â”â—â”â” (0-51) â”‚   â”‚
â”‚  â”‚ é¢„è®¾ï¼š     [Medium â–¼]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  ğŸš€ ç¡¬ä»¶åŠ é€Ÿ                              â”‚
â”‚  â˜‘ï¸ å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ [VideoToolbox â–¼]       â”‚
â”‚                                          â”‚
â”‚  ğŸ”§ é«˜çº§é€‰é¡¹ (æŠ˜å )                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜ è£å‰ªæ—¶é—´æ®µ                      â”‚   â”‚
â”‚  â”‚ â˜ è°ƒæ•´éŸ³é‡                        â”‚   â”‚
â”‚  â”‚ â˜ ä¸¤éç¼–ç ï¼ˆæ›´é«˜è´¨é‡ï¼‰             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  ğŸ’¾ è¾“å‡ºè·¯å¾„ï¼š                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ¡Œé¢/output.mp4        [æµè§ˆ...]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ è¿›åº¦ï¼š45% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘    â”‚        â”‚
â”‚  â”‚ é€Ÿåº¦ï¼š2.3x  é¢„è®¡å‰©ä½™ï¼š1åˆ†30ç§’ â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                          â”‚
â”‚       [å¼€å§‹è½¬ç ]  [å–æ¶ˆ]  [æ‰“å¼€è¾“å‡º]     â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» å››ã€æŠ€æœ¯å®ç°

### 4.1 æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ ipc/
â”‚   â”‚   â””â”€â”€ transcode.handlers.ts        # IPC å¤„ç†å™¨
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ TranscodeService.ts          # è½¬ç æœåŠ¡
â”œâ”€â”€ renderer/
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ Features/
â”‚           â””â”€â”€ TranscodeTab.tsx         # è½¬ç ç•Œé¢ç»„ä»¶
â””â”€â”€ types/
    â””â”€â”€ transcode.types.ts               # ç±»å‹å®šä¹‰
```

### 4.2 æ ¸å¿ƒç±»å‹å®šä¹‰

**`src/types/transcode.types.ts`**

```typescript
/**
 * è§†é¢‘è½¬ç é…ç½®
 */
export interface TranscodeConfig {
  // ===== è¾“å…¥è¾“å‡º =====
  inputPath: string;
  outputPath: string;
  
  // ===== æ ¼å¼å’Œç¼–ç  =====
  format: 'mp4' | 'mkv' | 'avi' | 'mov' | 'webm' | 'flv';
  videoCodec: 'libx264' | 'libx265' | 'vp9' | 'av1' | 'copy';
  audioCodec: 'aac' | 'mp3' | 'opus' | 'flac' | 'copy';
  
  // ===== è§†é¢‘å‚æ•° =====
  resolution?: {
    width: number;
    height: number;
  } | 'original';
  framerate?: number | 'original';
  
  // ===== è´¨é‡æ§åˆ¶ =====
  qualityMode: 'crf' | 'bitrate';
  crf?: number;              // 0-51, é»˜è®¤ 23 (è¶Šå°è´¨é‡è¶Šå¥½)
  videoBitrate?: string;     // å¦‚ "5M"
  audioBitrate?: string;     // å¦‚ "192k"
  preset: 'ultrafast' | 'superfast' | 'veryfast' | 'faster' | 'fast' | 
          'medium' | 'slow' | 'slower' | 'veryslow';
  
  // ===== ç¡¬ä»¶åŠ é€Ÿ =====
  useHardwareAccel: boolean;
  hwaccel: 'none' | 'videotoolbox' | 'nvenc' | 'qsv';
  
  // ===== é«˜çº§é€‰é¡¹ =====
  trim?: {
    start: string;  // "00:00:10"
    end: string;    // "00:05:30"
  };
  volume?: number;  // 0.5 = 50%, 2.0 = 200%
  twoPass?: boolean;
}

/**
 * è§†é¢‘æ–‡ä»¶ä¿¡æ¯
 */
export interface VideoInfo {
  duration: number;      // æ—¶é•¿ï¼ˆç§’ï¼‰
  width: number;         // å®½åº¦
  height: number;        // é«˜åº¦
  fps: number;          // å¸§ç‡
  videoCodec: string;   // è§†é¢‘ç¼–ç 
  audioCodec: string;   // éŸ³é¢‘ç¼–ç 
  bitrate: number;      // æ¯”ç‰¹ç‡ï¼ˆbpsï¼‰
  size: number;         // æ–‡ä»¶å¤§å°ï¼ˆbytesï¼‰
}

/**
 * è½¬ç è¿›åº¦ä¿¡æ¯
 */
export interface TranscodeProgress {
  percent: number;       // å®Œæˆç™¾åˆ†æ¯” (0-100)
  currentTime: number;   // å½“å‰å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰
  speed: number;         // å¤„ç†é€Ÿåº¦ï¼ˆå€æ•°ï¼Œå¦‚ 2.3xï¼‰
  eta: number;          // é¢„è®¡å‰©ä½™æ—¶é—´ï¼ˆç§’ï¼‰
  fps: number;          // å½“å‰å¤„ç†å¸§ç‡
}
```

### 4.3 FFmpeg å‘½ä»¤æ„å»º

**`src/main/services/TranscodeService.ts` æ ¸å¿ƒæ–¹æ³•**

```typescript
import ffmpeg from 'fluent-ffmpeg';
import log from 'electron-log';
import { TranscodeConfig, TranscodeProgress } from '../../types/transcode.types';

export class TranscodeService {
  /**
   * æ„å»º FFmpeg å‘½ä»¤å‚æ•°
   */
  private buildFFmpegCommand(config: TranscodeConfig): string[] {
    const options: string[] = [];
    
    // ===== ç¡¬ä»¶åŠ é€Ÿï¼ˆè§£ç ï¼‰ =====
    if (config.useHardwareAccel && config.hwaccel !== 'none') {
      if (config.hwaccel === 'videotoolbox') {
        options.push('-hwaccel', 'videotoolbox');
      } else if (config.hwaccel === 'nvenc') {
        options.push('-hwaccel', 'cuda');
        options.push('-hwaccel_output_format', 'cuda');
      } else if (config.hwaccel === 'qsv') {
        options.push('-hwaccel', 'qsv');
      }
    }
    
    // ===== è¾“å…¥æ–‡ä»¶ =====
    options.push('-i', config.inputPath);
    
    // ===== æ—¶é—´è£å‰ª =====
    if (config.trim) {
      options.push('-ss', config.trim.start);
      options.push('-to', config.trim.end);
    }
    
    // ===== è§†é¢‘ç¼–ç  =====
    if (config.videoCodec !== 'copy') {
      const videoCodec = this.getVideoCodec(config);
      options.push('-c:v', videoCodec);
      
      // è´¨é‡æ§åˆ¶
      if (config.qualityMode === 'crf' && config.crf !== undefined) {
        // VideoToolbox ä¸æ”¯æŒ CRFï¼Œä½¿ç”¨æ¯”ç‰¹ç‡ä»£æ›¿
        if (config.hwaccel === 'videotoolbox') {
          const bitrate = this.crfToBitrate(config.crf);
          options.push('-b:v', bitrate);
          options.push('-maxrate', `${parseInt(bitrate) * 1.2}M`);
          options.push('-bufsize', `${parseInt(bitrate) * 2}M`);
        } else {
          options.push('-crf', config.crf.toString());
        }
      } else if (config.videoBitrate) {
        options.push('-b:v', config.videoBitrate);
      }
      
      // é¢„è®¾ï¼ˆè½¯ä»¶ç¼–ç ï¼‰
      if (!config.useHardwareAccel || config.hwaccel === 'none') {
        options.push('-preset', config.preset);
      }
      
      // åˆ†è¾¨ç‡è°ƒæ•´
      if (config.resolution && config.resolution !== 'original') {
        const { width, height } = config.resolution;
        options.push('-vf', `scale=${width}:${height}`);
      }
      
      // å¸§ç‡è°ƒæ•´
      if (config.framerate && config.framerate !== 'original') {
        options.push('-r', config.framerate.toString());
      }
    } else {
      options.push('-c:v', 'copy');
    }
    
    // ===== éŸ³é¢‘ç¼–ç  =====
    if (config.audioCodec !== 'copy') {
      options.push('-c:a', config.audioCodec);
      
      if (config.audioBitrate) {
        options.push('-b:a', config.audioBitrate);
      }
      
      // éŸ³é‡è°ƒæ•´
      if (config.volume && config.volume !== 1.0) {
        options.push('-af', `volume=${config.volume}`);
      }
    } else {
      options.push('-c:a', 'copy');
    }
    
    // ===== è¾“å‡º =====
    options.push('-y'); // è¦†ç›–å·²å­˜åœ¨æ–‡ä»¶
    options.push(config.outputPath);
    
    return options;
  }
  
  /**
   * è·å–ç¡¬ä»¶ç¼–ç å™¨åç§°
   */
  private getVideoCodec(config: TranscodeConfig): string {
    if (!config.useHardwareAccel || config.hwaccel === 'none') {
      return config.videoCodec;
    }
    
    // ç¡¬ä»¶ç¼–ç å™¨æ˜ å°„
    const hwCodecMap: Record<string, Record<string, string>> = {
      videotoolbox: {
        libx264: 'h264_videotoolbox',
        libx265: 'hevc_videotoolbox',
      },
      nvenc: {
        libx264: 'h264_nvenc',
        libx265: 'hevc_nvenc',
      },
      qsv: {
        libx264: 'h264_qsv',
        libx265: 'hevc_qsv',
      },
    };
    
    return hwCodecMap[config.hwaccel]?.[config.videoCodec] || config.videoCodec;
  }
  
  /**
   * CRF è½¬æ¯”ç‰¹ç‡ï¼ˆç²—ç•¥ä¼°ç®—ï¼‰
   */
  private crfToBitrate(crf: number): string {
    // 1080p ä¼°ç®—å€¼
    const bitrateMap: Record<number, number> = {
      18: 10, 20: 8, 23: 5, 26: 3, 28: 2, 30: 1.5
    };
    
    const bitrate = bitrateMap[crf] || 5;
    return `${bitrate}M`;
  }
  
  /**
   * æ‰§è¡Œè½¬ç 
   */
  public async transcode(
    config: TranscodeConfig,
    onProgress: (progress: TranscodeProgress) => void
  ): Promise<void> {
    return new Promise((resolve, reject) => {
      const command = ffmpeg(config.inputPath);
      const options = this.buildFFmpegCommand(config);
      
      log.info('FFmpeg è½¬ç å‘½ä»¤:', options.join(' '));
      
      // åº”ç”¨å‚æ•°
      command.outputOptions(options);
      
      // è¿›åº¦ç›‘å¬
      command.on('progress', (progress) => {
        const { percent, timemark, currentFps } = progress;
        
        onProgress({
          percent: Math.round(percent || 0),
          currentTime: this.parseTimemark(timemark),
          speed: currentFps / 25, // å‡è®¾åŸå§‹ 25fps
          fps: currentFps,
          eta: 0, // éœ€è¦è®¡ç®—
        });
      });
      
      // å®Œæˆ
      command.on('end', () => {
        log.info('è½¬ç å®Œæˆ:', config.outputPath);
        resolve();
      });
      
      // é”™è¯¯
      command.on('error', (err) => {
        log.error('è½¬ç å¤±è´¥:', err);
        reject(err);
      });
      
      // æ‰§è¡Œ
      command.run();
    });
  }
  
  /**
   * è§£ææ—¶é—´æ ‡è®°
   */
  private parseTimemark(timemark: string): number {
    const parts = timemark.split(':');
    const hours = parseInt(parts[0]);
    const minutes = parseInt(parts[1]);
    const seconds = parseFloat(parts[2]);
    return hours * 3600 + minutes * 60 + seconds;
  }
}
```

### 4.4 é¢„è®¾æ¨¡æ¿

**å¸¸ç”¨è½¬ç é¢„è®¾**

```typescript
export const TRANSCODE_PRESETS = {
  // Web ä¼˜åŒ– (é€‚åˆç½‘é¡µæ’­æ”¾)
  webOptimized: {
    name: 'Web ä¼˜åŒ–',
    description: 'é€‚åˆç½‘é¡µå’Œæµåª’ä½“æ’­æ”¾',
    format: 'mp4',
    videoCodec: 'libx264',
    audioCodec: 'aac',
    qualityMode: 'crf',
    crf: 23,
    preset: 'medium',
    audioBitrate: '128k',
    resolution: { width: 1920, height: 1080 },
  },
  
  // ç§»åŠ¨è®¾å¤‡ (è¾ƒå°æ–‡ä»¶)
  mobile: {
    name: 'ç§»åŠ¨è®¾å¤‡',
    description: 'é€‚åˆæ‰‹æœºå¹³æ¿è§‚çœ‹ï¼Œæ–‡ä»¶è¾ƒå°',
    format: 'mp4',
    videoCodec: 'libx264',
    audioCodec: 'aac',
    qualityMode: 'crf',
    crf: 26,
    preset: 'fast',
    audioBitrate: '96k',
    resolution: { width: 1280, height: 720 },
  },
  
  // é«˜è´¨é‡ (é€‚åˆå­˜æ¡£)
  highQuality: {
    name: 'é«˜è´¨é‡',
    description: 'æœ€ä½³ç”»è´¨ï¼Œé€‚åˆé•¿æœŸä¿å­˜',
    format: 'mkv',
    videoCodec: 'libx265',
    audioCodec: 'flac',
    qualityMode: 'crf',
    crf: 18,
    preset: 'slow',
    resolution: 'original',
  },
  
  // å°æ–‡ä»¶ (èŠ‚çœç©ºé—´)
  smallFile: {
    name: 'å°æ–‡ä»¶',
    description: 'æåº¦å‹ç¼©ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´',
    format: 'mp4',
    videoCodec: 'libx265',
    audioCodec: 'aac',
    qualityMode: 'crf',
    crf: 28,
    preset: 'medium',
    audioBitrate: '64k',
    resolution: { width: 1280, height: 720 },
  },
  
  // å¿«é€Ÿè½¬ç  (é€Ÿåº¦ä¼˜å…ˆ)
  fast: {
    name: 'å¿«é€Ÿè½¬ç ',
    description: 'è½¬ç é€Ÿåº¦æœ€å¿«ï¼Œè´¨é‡ä¸€èˆ¬',
    format: 'mp4',
    videoCodec: 'libx264',
    audioCodec: 'aac',
    qualityMode: 'crf',
    crf: 23,
    preset: 'veryfast',
    resolution: 'original',
  },
};
```

---

## ğŸ“ äº”ã€å®ç°æ­¥éª¤

### Phase 1: åŸºç¡€åŠŸèƒ½ (1-2å¤©)

**ç›®æ ‡ï¼šå®ç°æœ€å°å¯ç”¨ç‰ˆæœ¬**

- [ ] åˆ›å»ºç±»å‹å®šä¹‰æ–‡ä»¶ `transcode.types.ts`
- [ ] å®ç° `TranscodeService` åŸºç¡€æœåŠ¡
- [ ] å®ç° IPC é€šä¿¡å¤„ç†å™¨
- [ ] åˆ›å»ºåŸºç¡€ UI ç•Œé¢ï¼ˆæ–‡ä»¶é€‰æ‹© + å¼€å§‹æŒ‰é’®ï¼‰
- [ ] å®ç°åŸºæœ¬è½¬ç åŠŸèƒ½ï¼ˆMP4 â†’ MP4, H.264 â†’ H.264ï¼‰

**éªŒæ”¶æ ‡å‡†**ï¼šèƒ½å¤Ÿå®Œæˆæœ€åŸºæœ¬çš„è§†é¢‘æ ¼å¼è½¬æ¢

### Phase 2: å®Œå–„åŠŸèƒ½ (2-3å¤©)

**ç›®æ ‡ï¼šæ”¯æŒå¤šç§æ ¼å¼å’Œå‚æ•°è°ƒæ•´**

- [ ] æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼ˆMP4, MKV, WebMï¼‰
- [ ] æ”¯æŒå¤šç§è§†é¢‘ç¼–ç ï¼ˆH.264, H.265, VP9ï¼‰
- [ ] æ”¯æŒå¤šç§éŸ³é¢‘ç¼–ç ï¼ˆAAC, MP3, Opusï¼‰
- [ ] å®ç°è´¨é‡æ§åˆ¶ï¼ˆCRF æ»‘å—ï¼‰
- [ ] å®ç°åˆ†è¾¨ç‡è°ƒæ•´ä¸‹æ‹‰æ¡†
- [ ] å®ç°å¸§ç‡è°ƒæ•´ä¸‹æ‹‰æ¡†
- [ ] å®ç°ç¡¬ä»¶åŠ é€Ÿå¼€å…³
- [ ] ä¼˜åŒ–è¿›åº¦æ˜¾ç¤ºï¼ˆç™¾åˆ†æ¯” + é€Ÿåº¦ + ETAï¼‰

**éªŒæ”¶æ ‡å‡†**ï¼šæ”¯æŒå¸¸è§çš„è½¬ç åœºæ™¯å’Œå‚æ•°è°ƒæ•´

### Phase 3: é«˜çº§åŠŸèƒ½ (2-3å¤©)

**ç›®æ ‡ï¼šå¢å¼ºç”¨æˆ·ä½“éªŒå’Œé«˜çº§é€‰é¡¹**

- [ ] å®ç°é¢„è®¾æ¨¡æ¿é€‰æ‹©
- [ ] å®ç°è§†é¢‘æ—¶é—´è£å‰ªåŠŸèƒ½
- [ ] å®ç°éŸ³é‡è°ƒæ•´åŠŸèƒ½
- [ ] å®ç°ä¸¤éç¼–ç é€‰é¡¹
- [ ] æ˜¾ç¤ºè¾“å…¥è§†é¢‘è¯¦ç»†ä¿¡æ¯
- [ ] é¢„ä¼°è¾“å‡ºæ–‡ä»¶å¤§å°
- [ ] æ”¯æŒä¸­æ–­å’Œæ¢å¤
- [ ] å®Œå–„é”™è¯¯å¤„ç†å’Œæç¤º

**éªŒæ”¶æ ‡å‡†**ï¼šæä¾›å®Œæ•´çš„é«˜çº§åŠŸèƒ½å’Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ

### Phase 4: ä¼˜åŒ–å’Œæµ‹è¯• (1-2å¤©)

**ç›®æ ‡ï¼šç¨³å®šæ€§å’Œæ€§èƒ½ä¼˜åŒ–**

- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¤§æ–‡ä»¶å¤„ç†ï¼‰
- [ ] UI/UX ä¼˜åŒ–ï¼ˆå“åº”å¼ã€æµç•…åº¦ï¼‰
- [ ] å…¨é¢åŠŸèƒ½æµ‹è¯•
- [ ] å¤šå¹³å°å…¼å®¹æ€§æµ‹è¯•
- [ ] è¾¹ç•Œæƒ…å†µæµ‹è¯•
- [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£
- [ ] ä»£ç å®¡æŸ¥å’Œé‡æ„

**éªŒæ”¶æ ‡å‡†**ï¼šåŠŸèƒ½ç¨³å®šï¼Œä½“éªŒæµç•…ï¼Œæ— æ˜æ˜¾ bug

---

## âš ï¸ å…­ã€æ³¨æ„äº‹é¡¹

### 6.1 æ€§èƒ½è€ƒè™‘

- **å¤§æ–‡ä»¶å¤„ç†**ï¼šè§†é¢‘æ–‡ä»¶å¯èƒ½éå¸¸å¤§ï¼ˆ>10GBï¼‰ï¼Œéœ€è¦ï¼š
  - åˆ†å—å¤„ç†é¿å…å†…å­˜æº¢å‡º
  - æ¸…æ™°çš„è¿›åº¦æç¤º
  - æ”¯æŒæš‚åœ/æ¢å¤/å–æ¶ˆ
  
- **ç¡¬ä»¶åŠ é€Ÿ**ï¼š
  - VideoToolbox (macOS): 3-10å€é€Ÿåº¦æå‡
  - NVENC (NVIDIA): 5-15å€é€Ÿåº¦æå‡
  - QSV (Intel): 3-8å€é€Ÿåº¦æå‡
  - éœ€è¦æ£€æµ‹ç¡¬ä»¶æ”¯æŒæƒ…å†µ

- **ä¸¤éç¼–ç **ï¼š
  - è´¨é‡æå‡çº¦ 10-20%
  - æ—¶é—´å¢åŠ  100%ï¼ˆç¿»å€ï¼‰
  - é€‚åˆè¿½æ±‚æè‡´è´¨é‡çš„åœºæ™¯

### 6.2 å…¼å®¹æ€§é—®é¢˜

- **ç¼–ç å™¨å‚æ•°**ï¼šä¸åŒç¼–ç å™¨å¯¹å‚æ•°æ”¯æŒä¸åŒ
  - libx264: æ”¯æŒ CRF, preset
  - h264_videotoolbox: ä¸æ”¯æŒ CRFï¼Œéœ€ç”¨æ¯”ç‰¹ç‡
  - h264_nvenc: å‚æ•°åç§°ä¸åŒ (preset â†’ preset)

- **æ ¼å¼é™åˆ¶**ï¼šæŸäº›ç¼–ç ä¸æ”¯æŒæŸäº›å®¹å™¨
  - VP9 â†’ æ¨è WebM
  - H.265 â†’ æ¨è MP4 æˆ– MKV
  - FLAC â†’ æ¨è MKVï¼ˆMP4 ä¸æ”¯æŒï¼‰

- **å¹³å°å·®å¼‚**ï¼š
  - macOS: ä»…æ”¯æŒ VideoToolbox
  - Windows: æ”¯æŒ NVENC, QSV
  - Linux: ä¸»è¦ä½¿ç”¨è½¯ä»¶ç¼–ç 

### 6.3 ç”¨æˆ·ä½“éªŒ

- **é¢„è®¾æ¨¡æ¿**ï¼šé™ä½ä¸“ä¸šé—¨æ§›
  - å¤§å¤šæ•°ç”¨æˆ·ä¸äº†è§£ç¼–ç å‚æ•°
  - æä¾›åœºæ™¯åŒ–é¢„è®¾ï¼ˆWebã€Mobileã€Archiveï¼‰
  - å…è®¸åœ¨é¢„è®¾åŸºç¡€ä¸Šå¾®è°ƒ

- **å®æ—¶åé¦ˆ**ï¼š
  - æ¸…æ™°çš„è¿›åº¦æ¡
  - å®æ—¶é€Ÿåº¦å’Œå‰©ä½™æ—¶é—´
  - é¢„ä¼°è¾“å‡ºæ–‡ä»¶å¤§å°

- **é”™è¯¯å¤„ç†**ï¼š
  - å‹å¥½çš„é”™è¯¯æç¤º
  - æä¾›è§£å†³æ–¹æ¡ˆå»ºè®®
  - è¯¦ç»†çš„æ—¥å¿—è®°å½•

### 6.4 å®‰å…¨æ€§

- **è·¯å¾„éªŒè¯**ï¼šé˜²æ­¢è·¯å¾„æ³¨å…¥æ”»å‡»
- **ç£ç›˜ç©ºé—´**ï¼šè½¬ç å‰æ£€æŸ¥å‰©ä½™ç©ºé—´
- **æ–‡ä»¶æƒé™**ï¼šæ£€æŸ¥è¯»å†™æƒé™
- **èµ„æºé™åˆ¶**ï¼šé¿å…åŒæ—¶è½¬ç è¿‡å¤šæ–‡ä»¶

---

## ğŸ§ª ä¸ƒã€æµ‹è¯•ç”¨ä¾‹

### 7.1 åŠŸèƒ½æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | è¾“å…¥ | é¢„æœŸè¾“å‡º | ä¼˜å…ˆçº§ |
|---------|------|---------|--------|
| åŸºæœ¬è½¬ç  | MP4 (H.264) | MP4 (H.264) | P0 |
| ç¼–ç è½¬æ¢ | MP4 (H.264) | MP4 (H.265) | P0 |
| æ ¼å¼è½¬æ¢ | MP4 | MKV | P0 |
| é™ä½åˆ†è¾¨ç‡ | 4K (3840x2160) | 1080p (1920x1080) | P1 |
| é™ä½å¸§ç‡ | 60fps | 30fps | P1 |
| è´¨é‡è°ƒæ•´ | CRF 23 | CRF 18 (é«˜è´¨é‡) | P1 |
| ç¡¬ä»¶åŠ é€Ÿ | è½¯ä»¶ç¼–ç  vs VideoToolbox | é€Ÿåº¦æå‡ 3-10x | P0 |
| æ—¶é—´è£å‰ª | 00:00:10 - 00:05:30 | 5åˆ†20ç§’è§†é¢‘ | P2 |
| éŸ³é‡è°ƒæ•´ | éŸ³é‡ x2.0 | éŸ³é‡æå‡ä¸€å€ | P2 |

### 7.2 æ€§èƒ½æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | æ–‡ä»¶å¤§å° | é¢„æœŸç»“æœ |
|---------|---------|---------|
| å°æ–‡ä»¶ | < 100MB | æµç•…å¤„ç† |
| ä¸­ç­‰æ–‡ä»¶ | 100MB - 2GB | æ­£å¸¸å¤„ç† |
| å¤§æ–‡ä»¶ | 2GB - 10GB | ç¨³å®šå¤„ç†ï¼Œæ— å†…å­˜æº¢å‡º |
| è¶…å¤§æ–‡ä»¶ | > 10GB | æ”¯æŒå¤„ç†ï¼Œå¯èƒ½è¾ƒæ…¢ |

### 7.3 è¾¹ç•Œæµ‹è¯•

- âŒ æ— æ•ˆæ–‡ä»¶è·¯å¾„
- âŒ æŸåçš„è§†é¢‘æ–‡ä»¶
- âŒ ç£ç›˜ç©ºé—´ä¸è¶³
- âŒ ä¸­é€”å–æ¶ˆè½¬ç 
- âŒ ç³»ç»Ÿä¼‘çœ /å…³æœº
- âŒ ç½‘ç»œå­˜å‚¨è·¯å¾„
- âŒ ç‰¹æ®Šå­—ç¬¦æ–‡ä»¶å

---

## ğŸ“Š å…«ã€æ€§èƒ½æŒ‡æ ‡

### è½¬ç é€Ÿåº¦å¯¹æ¯”

**æµ‹è¯•ç¯å¢ƒ**ï¼š1080p 30fps H.264 è§†é¢‘ï¼Œ5åˆ†é’Ÿæ—¶é•¿

| ç¼–ç æ–¹å¼ | å¤„ç†æ—¶é—´ | é€Ÿåº¦å€æ•° | è´¨é‡ |
|---------|---------|---------|-----|
| libx264 (fast) | 3åˆ†é’Ÿ | 1.67x | è‰¯å¥½ |
| libx264 (medium) | 5åˆ†é’Ÿ | 1.0x | ä¼˜ç§€ |
| libx264 (slow) | 10åˆ†é’Ÿ | 0.5x | æä½³ |
| h264_videotoolbox | 1åˆ†é’Ÿ | 5.0x | è‰¯å¥½ |
| h264_nvenc | 40ç§’ | 7.5x | è‰¯å¥½ |

### æ–‡ä»¶å¤§å°å¯¹æ¯”

**æµ‹è¯•ç¯å¢ƒ**ï¼š1080p 30fpsï¼Œ5åˆ†é’Ÿæ—¶é•¿

| ç¼–ç  | CRF/è´¨é‡ | æ–‡ä»¶å¤§å° |
|-----|---------|---------|
| H.264 | CRF 18 | ~500MB |
| H.264 | CRF 23 | ~200MB |
| H.264 | CRF 28 | ~80MB |
| H.265 | CRF 23 | ~100MB |
| VP9 | CRF 30 | ~90MB |

---

## ğŸ“š ä¹ã€å‚è€ƒèµ„æ–™

### FFmpeg æ–‡æ¡£

- [FFmpeg å®˜æ–¹æ–‡æ¡£](https://ffmpeg.org/documentation.html)
- [H.264 ç¼–ç æŒ‡å—](https://trac.ffmpeg.org/wiki/Encode/H.264)
- [H.265 ç¼–ç æŒ‡å—](https://trac.ffmpeg.org/wiki/Encode/H.265)
- [ç¡¬ä»¶åŠ é€ŸæŒ‡å—](https://trac.ffmpeg.org/wiki/HWAccelIntro)

### ç¼–ç å‚æ•°è¯´æ˜

**CRF (Constant Rate Factor)**
- èŒƒå›´ï¼š0-51 (0=æ— æŸ, 51=æœ€å·®)
- æ¨èå€¼ï¼š
  - 18-20: é«˜è´¨é‡ï¼ˆè§†è§‰æ— æŸï¼‰
  - 23: é»˜è®¤å€¼ï¼ˆè‰¯å¥½è´¨é‡ï¼‰
  - 26-28: å¯æ¥å—è´¨é‡ï¼ˆè¾ƒå°æ–‡ä»¶ï¼‰

**Presetï¼ˆç¼–ç é€Ÿåº¦ï¼‰**
- ultrafast: æå¿«ï¼Œè´¨é‡å·®
- fast: å¿«é€Ÿï¼Œè´¨é‡ä¸€èˆ¬
- medium: é»˜è®¤ï¼Œå¹³è¡¡
- slow: æ…¢é€Ÿï¼Œè´¨é‡å¥½
- veryslow: ææ…¢ï¼Œè´¨é‡æä½³

---

## ğŸ¯ åã€æˆåŠŸæ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§

- âœ… æ”¯æŒè‡³å°‘ 3 ç§æ ¼å¼è½¬æ¢ï¼ˆMP4, MKV, WebMï¼‰
- âœ… æ”¯æŒè‡³å°‘ 3 ç§è§†é¢‘ç¼–ç ï¼ˆH.264, H.265, VP9ï¼‰
- âœ… æ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼ˆè‡³å°‘æ”¯æŒ VideoToolboxï¼‰
- âœ… æ”¯æŒåˆ†è¾¨ç‡å’Œå¸§ç‡è°ƒæ•´
- âœ… æä¾›è‡³å°‘ 3 ä¸ªé¢„è®¾æ¨¡æ¿

### æ€§èƒ½æ ‡å‡†

- âœ… ç¡¬ä»¶åŠ é€Ÿé€Ÿåº¦æå‡è‡³å°‘ 3 å€
- âœ… æ”¯æŒå¤„ç† 10GB ä»¥ä¸Šå¤§æ–‡ä»¶
- âœ… UI å“åº”æµç•…ï¼Œæ— æ˜æ˜¾å¡é¡¿

### ç”¨æˆ·ä½“éªŒ

- âœ… ç•Œé¢ç®€æ´ç›´è§‚ï¼Œæ˜“äºç†è§£
- âœ… è¿›åº¦æ˜¾ç¤ºæ¸…æ™°å‡†ç¡®
- âœ… é”™è¯¯æç¤ºå‹å¥½æœ‰ç”¨
- âœ… é¢„è®¾æ¨¡æ¿æ»¡è¶³ 80% å¸¸è§éœ€æ±‚

### ç¨³å®šæ€§

- âœ… è¿ç»­è½¬ç  10 ä¸ªæ–‡ä»¶æ— å´©æºƒ
- âœ… å„ç§è¾¹ç•Œæƒ…å†µå¤„ç†æ­£ç¡®
- âœ… å†…å­˜å ç”¨åˆç†ï¼ˆ< 500MBï¼‰

---

## ğŸ“ åä¸€ã€åç»­ä¼˜åŒ–æ–¹å‘

### v1.1 å¢å¼ºç‰ˆ

- ğŸ”„ æ‰¹é‡è½¬ç æ”¯æŒ
- ğŸ”„ æ‹–æ‹½æ–‡ä»¶ä¸Šä¼ 
- ğŸ”„ è½¬ç é˜Ÿåˆ—ç®¡ç†
- ğŸ”„ å†å²è®°å½•æŸ¥çœ‹

### v1.2 ä¸“ä¸šç‰ˆ

- ğŸ”„ è§†é¢‘æ»¤é•œï¼ˆè°ƒè‰²ã€é”åŒ–ç­‰ï¼‰
- ğŸ”„ æ·»åŠ æ°´å°/å­—å¹•
- ğŸ”„ è§†é¢‘æ‹¼æ¥/åˆ†å‰²
- ğŸ”„ é«˜çº§å‚æ•°è‡ªå®šä¹‰

### v1.3 æ™ºèƒ½ç‰ˆ

- ğŸ”„ AI è‡ªåŠ¨å‚æ•°ä¼˜åŒ–
- ğŸ”„ æ™ºèƒ½è´¨é‡è¯„ä¼°
- ğŸ”„ é¢„è®¾æ¨¡æ¿æ¨è
- ğŸ”„ è½¬ç ç»“æœé¢„è§ˆ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-30  
**ä½œè€…**: AI Assistant


# å¼€å‘è¿›ç¨‹ç®¡ç†æŒ‡å—

## ğŸ¯ é—®é¢˜èƒŒæ™¯

åœ¨ä½¿ç”¨ `pnpm run dev` å¯åŠ¨ Electron + Vite å¼€å‘ç¯å¢ƒæ—¶ï¼ŒæŒ‰ `Ctrl+C` åœæ­¢åå¯èƒ½ä¼šæœ‰æ®‹ç•™è¿›ç¨‹ï¼Œå¯¼è‡´ï¼š
- ç«¯å£è¢«å ç”¨ï¼ˆå¦‚ 5173ï¼‰
- æ— æ³•æ­£å¸¸é‡æ–°å¯åŠ¨
- éœ€è¦æ‰‹åŠ¨æ€è¿›ç¨‹
- åˆ é™¤ `dist` ç›®å½•é‡æ–°ç¼–è¯‘ä¹Ÿæ— æ•ˆ

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ³• 1ï¼šä½¿ç”¨å®‰å…¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
pnpm run dev
```

**æ–°çš„ `dev` å‘½ä»¤ä¼šè‡ªåŠ¨ï¼š**
1. âœ… å¯åŠ¨å‰æ¸…ç†æ®‹ç•™è¿›ç¨‹
2. âœ… æ­£å¸¸å¯åŠ¨å¼€å‘ç¯å¢ƒ
3. âœ… Ctrl+C æ—¶å®Œå…¨æ¸…ç†æ‰€æœ‰è¿›ç¨‹

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨æ¸…ç†æ®‹ç•™è¿›ç¨‹

å¦‚æœå‘ç°æœ‰æ®‹ç•™è¿›ç¨‹ï¼Œéšæ—¶è¿è¡Œï¼š

```bash
pnpm run kill-dev
```

è¿™ä¼šæ¸…ç†æ‰€æœ‰ä¸ VideoTool ç›¸å…³çš„æ®‹ç•™è¿›ç¨‹ã€‚

### æ–¹æ³• 3ï¼šä½¿ç”¨åŸå§‹å‘½ä»¤ï¼ˆä¸æ¨èï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨åŸæ¥çš„æ–¹å¼ï¼š

```bash
pnpm run dev:concurrent
```

âš ï¸ **æ³¨æ„**ï¼šè¿™ç§æ–¹å¼å¯èƒ½ä»ä¼šæœ‰æ®‹ç•™è¿›ç¨‹é—®é¢˜ã€‚

---

## ğŸ”§ å·¥ä½œåŸç†

### 1. å®‰å…¨å¯åŠ¨è„šæœ¬ (`scripts/dev-safe.js`)

- **å¯åŠ¨å‰æ¸…ç†**ï¼šè‡ªåŠ¨æ€æ­»ä¸Šæ¬¡è¿è¡Œçš„æ®‹ç•™è¿›ç¨‹
- **ä¿¡å·æ•è·**ï¼šç›‘å¬ `Ctrl+C` (SIGINT) ä¿¡å·
- **å®Œå…¨æ¸…ç†**ï¼šé€€å‡ºæ—¶ç¡®ä¿æ‰€æœ‰å­è¿›ç¨‹éƒ½è¢«æ€æ­»
- **å»¶æ—¶ä¿æŠ¤**ï¼šå¦‚æœå­è¿›ç¨‹ 2 ç§’å†…æ²¡å“åº”ï¼Œå¼ºåˆ¶æ€æ­» (SIGKILL)

### 2. æ¸…ç†è„šæœ¬ (`scripts/kill-dev.js`)

æŸ¥æ‰¾å¹¶æ€æ­»ä»¥ä¸‹è¿›ç¨‹ï¼š
- `electron.*VideoTool` - Electron ä¸»è¿›ç¨‹
- `vite.*VideoTool` - Vite å¼€å‘æœåŠ¡å™¨
- `node.*VideoTool` - Node æ„å»ºè¿›ç¨‹
- `esbuild.*VideoTool` - esbuild ç¼–è¯‘è¿›ç¨‹
- `pnpm.*dev` - pnpm å¯åŠ¨å™¨

### 3. æ”¹è¿›çš„ concurrently å‚æ•°

```json
"dev:concurrent": "concurrently \"pnpm:dev:renderer\" \"pnpm:dev:main\" -k -r --kill-others"
```

- `-k` (kill-others): ä»»ä¸€è¿›ç¨‹é€€å‡ºæ—¶æ€æ­»å…¶ä»–è¿›ç¨‹
- `-r` (raw): ä¿ç•™åŸå§‹è¾“å‡ºæ ¼å¼
- `--kill-others`: ç¡®ä¿æ‰€æœ‰è¿›ç¨‹éƒ½è¢«ç»ˆæ­¢

---

## ğŸ“‹ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆ Ctrl+C åè¿˜æœ‰æ®‹ç•™è¿›ç¨‹ï¼Ÿ

**A**: Electron å¼€å‘ç¯å¢ƒå¯åŠ¨äº†å¤šä¸ªå­è¿›ç¨‹ï¼š
- ä¸»è¿›ç¨‹ (Electron)
- æ¸²æŸ“è¿›ç¨‹ (Vite dev server)
- æ„å»ºè¿›ç¨‹ (esbuild, TypeScript)

`Ctrl+C` åªå‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œå­è¿›ç¨‹å¯èƒ½å˜æˆå­¤å„¿è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚

### Q2: å¦‚ä½•æ‰‹åŠ¨æ£€æŸ¥æ®‹ç•™è¿›ç¨‹ï¼Ÿ

**macOS/Linux**:
```bash
ps aux | grep -E "electron|vite|node" | grep VideoTool
```

**Windows**:
```cmd
tasklist | findstr "electron node"
```

### Q3: ç«¯å£ 5173 è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ

```bash
# macOS/Linux
lsof -ti:5173 | xargs kill -9

# Windows
netstat -ano | findstr :5173
taskkill /PID <PID> /F
```

æˆ–ç›´æ¥è¿è¡Œï¼š
```bash
pnpm run kill-dev
```

### Q4: å¦‚æœæ¸…ç†è„šæœ¬æ— æ•ˆæ€ä¹ˆåŠï¼Ÿ

æ‰‹åŠ¨å¼ºåˆ¶æ€æ­»ï¼š

**macOS/Linux**:
```bash
pkill -9 -f "electron.*VideoTool"
pkill -9 -f "vite"
pkill -9 -f "node.*dev"
```

**Windows**:
```cmd
taskkill /F /IM electron.exe
taskkill /F /IM node.exe
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å§‹ç»ˆä½¿ç”¨æ¨èå‘½ä»¤

```bash
# âœ… æ¨è
pnpm run dev

# âŒ ä¸æ¨è
pnpm run dev:concurrent  # å¯èƒ½æœ‰æ®‹ç•™è¿›ç¨‹
```

### 2. é‡å¯å‰å…ˆæ¸…ç†

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

```bash
# 1. æ¸…ç†æ®‹ç•™è¿›ç¨‹
pnpm run kill-dev

# 2. æ¸…ç†æ„å»ºäº§ç‰©ï¼ˆå¯é€‰ï¼‰
rm -rf dist

# 3. é‡æ–°å¯åŠ¨
pnpm run dev
```

### 3. å®šæœŸæ£€æŸ¥è¿›ç¨‹

å¼€å‘æ—¶å¦‚æœæ„Ÿè§‰å¡é¡¿ï¼š

```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep -E "electron|vite|node" | grep VideoTool

# æ¸…ç†
pnpm run kill-dev
```

### 4. æ­£ç¡®åœæ­¢å¼€å‘æœåŠ¡å™¨

- âœ… åœ¨å¯åŠ¨ç»ˆç«¯æŒ‰ `Ctrl+C`
- âœ… ç­‰å¾…æ¸…ç†å®Œæˆï¼ˆçœ‹åˆ° "æ¸…ç†å®Œæˆ" æç¤ºï¼‰
- âŒ ç›´æ¥å…³é—­ç»ˆç«¯çª—å£
- âŒ ç›´æ¥æ€æ­»ç»ˆç«¯è¿›ç¨‹

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒï¼ˆæ¨èï¼‰
pnpm run dev

# æ¸…ç†æ®‹ç•™è¿›ç¨‹
pnpm run kill-dev

# å®Œå…¨é‡å¯
pnpm run kill-dev && rm -rf dist && pnpm run dev

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
ps aux | grep VideoTool

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :5173
```

---

## ğŸ”„ è¿ç§»æŒ‡å—

å¦‚æœæ‚¨ä¹‹å‰ä¹ æƒ¯äº† `pnpm run dev`ï¼Œç°åœ¨ä¸éœ€è¦æ”¹å˜ä»»ä½•ä¹ æƒ¯ï¼

**ä¹‹å‰**:
```bash
pnpm run dev  # å¯èƒ½æœ‰æ®‹ç•™è¿›ç¨‹
# Ctrl+C
# æœ‰æ—¶éœ€è¦æ‰‹åŠ¨æ€è¿›ç¨‹
```

**ç°åœ¨**:
```bash
pnpm run dev  # è‡ªåŠ¨æ¸…ç† + å®‰å…¨é€€å‡º
# Ctrl+C
# è‡ªåŠ¨å®Œå…¨æ¸…ç†ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ
```

**å”¯ä¸€çš„åŒºåˆ«**ï¼šç°åœ¨æ›´å¯é ï¼Œä¸ä¼šæœ‰æ®‹ç•™è¿›ç¨‹ï¼âœ¨

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### è¿›ç¨‹æ¸…ç†ç­–ç•¥

1. **ä¼˜é›…å…³é—­** (SIGTERM): å…ˆå°è¯•è®©è¿›ç¨‹è‡ªå·±å…³é—­
2. **å¼ºåˆ¶æ€æ­»** (SIGKILL): å¦‚æœ 2 ç§’å†…æ²¡å“åº”ï¼Œå¼ºåˆ¶ç»ˆæ­¢
3. **æ¨¡å¼åŒ¹é…**: ä½¿ç”¨è¿›ç¨‹åç§°æ¨¡å¼åŒ¹é…ï¼Œé¿å…è¯¯æ€æ— å…³è¿›ç¨‹

### æ”¯æŒçš„å¹³å°

- âœ… macOS (darwin) - ä½¿ç”¨ `pkill` / `pgrep`
- âœ… Linux - ä½¿ç”¨ `pkill` / `pgrep`
- âœ… Windows - ä½¿ç”¨ `taskkill`

---

## ğŸ› æŠ¥å‘Šé—®é¢˜

å¦‚æœä»ç„¶é‡åˆ°æ®‹ç•™è¿›ç¨‹é—®é¢˜ï¼š

1. è¿è¡Œ `pnpm run kill-dev` å¹¶æˆªå›¾è¾“å‡º
2. è¿è¡Œ `ps aux | grep VideoTool` å¹¶æä¾›ç»“æœ
3. æä¾›æ“ä½œç³»ç»Ÿç‰ˆæœ¬å’Œç»ˆç«¯ç±»å‹
4. æè¿°é‡ç°æ­¥éª¤

---

**æœ€åæ›´æ–°**: 2025-11-01
**é€‚ç”¨ç‰ˆæœ¬**: VideoTool v1.1.0+

